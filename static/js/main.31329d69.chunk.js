(this["webpackJsonpour-telepathy"]=this["webpackJsonpour-telepathy"]||[]).push([[0],{104:function(e,t,n){},144:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(10),o=n.n(r),i=(n(104),n(46)),s=n(11),u=n(37),l=n(15),f=n(173),m=n(176),d=n(178),h=n(179),g=n(186),b=n(180),p=n(187),k=n(52),E=n(181),y=n(182),v=n(175),j=Object(f.a)((function(e){return{orange:{color:e.palette.getContrastText(v.a[500]),backgroundColor:v.a[500]},cardHeader:{alignItems:"center"},cardContent:{display:"flex",justifyContent:"space-between"},cardStatusChip:{alignSelf:"center"},cardAction:{width:"100%"}}}));function O(e){var t=e.member,n=j(),r=Object(a.useState)(""),o=Object(l.a)(r,2),i=o[0],s=o[1],u=Object(a.useState)("primary"),f=Object(l.a)(u,2),v=f[0],O=f[1];return Object(a.useEffect)((function(){!function(e){switch(e){case"working":s("\uc5c5\ubb34\uc911"),O("primary");break;case"meeting":s("\ud68c\uc758\uc911"),O("primary");break;case"meal":s("\uc2dd\uc0ac\uc911"),O("secondary");break;case"rest":s("\ud734\uc2dd\uc911"),O("secondary");break;case"offwork":s("\ud1f4\uadfc"),O("default")}}(t.status)})),c.a.createElement(m.a,{item:!0,xs:6,md:3},c.a.createElement(d.a,null,c.a.createElement(h.a,{className:n.cardHeader,action:c.a.createElement(g.a,{className:n.cardStatusChip,color:v,label:i})}),c.a.createElement(b.a,{className:n.cardContent},c.a.createElement(p.a,{className:n.orange},"O"),c.a.createElement(k.a,null,t.name)),c.a.createElement(E.a,null,c.a.createElement(y.a,{variant:"contained",color:"primary",className:n.cardAction},"Call"))))}var w=Object(f.a)({memberBox:{padding:"10px 40px",marginTop:"20px"}});function C(e){var t=e.memberList,n=(e.offerToMember,w());return c.a.createElement(m.a,{container:!0,spacing:3,className:n.memberBox},t.map((function(e){return c.a.createElement(O,{key:e.id,member:e})})))}var S=n(60),x=Object(f.a)((function(e){return{orange:{color:e.palette.getContrastText(v.a[500]),backgroundColor:v.a[500]},cardHeader:{alignItems:"center"},cardContent:{display:"flex",justifyContent:"space-between"},cardStatusChip:{alignSelf:"center"},workingStatusButton:{color:"#5843BE"},restStatusButton:{color:"#FFA067"},offStatusButton:{color:"#282828"}}}));function N(e){var t=e.myInfo,n=e.setMyInfo,r=x(),o=Object(a.useState)(""),i=Object(l.a)(o,2),s=i[0],u=i[1],f=Object(a.useState)("primary"),k=Object(l.a)(f,2),E=k[0],v=k[1];function j(e){switch(n(Object(S.a)(Object(S.a)({},t),{},{status:e})),e){case"working":u("\uc5c5\ubb34\uc911"),v("primary");break;case"meeting":u("\ud68c\uc758\uc911"),v("primary");break;case"meal":u("\uc2dd\uc0ac\uc911"),v("secondary");break;case"rest":u("\ud734\uc2dd\uc911"),v("secondary");break;case"offwork":u("\ud1f4\uadfc"),v("default")}}return Object(a.useEffect)((function(){j(t.status)}),[]),c.a.createElement(d.a,{elevation:0},c.a.createElement(h.a,{className:r.cardHeader,avatar:c.a.createElement(p.a,{className:r.orange},"\uc751"),title:t.name,action:c.a.createElement(g.a,{className:r.cardStatusChip,color:E,label:s})}),c.a.createElement(b.a,{className:r.cardContent},c.a.createElement(m.a,{item:!0,xs:"auto"},c.a.createElement(y.a,{variant:"working"==t.status?"contained":"text",color:E,onClick:function(){j("working")}},"\uc5c5\ubb34")),c.a.createElement(m.a,{item:!0,xs:"auto"},c.a.createElement(y.a,{variant:"meeting"==t.status?"contained":"text",color:E,onClick:function(){j("meeting")}},"\ud68c\uc758")),c.a.createElement(m.a,{item:!0,xs:"auto"},c.a.createElement(y.a,{variant:"rest"==t.status?"contained":"text",color:E,onClick:function(){j("rest")}},"\ud734\uc2dd")),c.a.createElement(m.a,{item:!0,xs:"auto"},c.a.createElement(y.a,{variant:"meal"==t.status?"contained":"text",color:E,onClick:function(){j("meal")}},"\uc2dd\uc0ac")),c.a.createElement(m.a,{item:!0,xs:"auto"},c.a.createElement(y.a,{variant:"offwork"==t.status?"contained":"text",color:E,onClick:function(){j("offwork")}},"\ud1f4\uadfc"))))}var I=n(51),M=n(84),B=n(85),L=new(function(){function e(){Object(I.a)(this,e),this.socket=Object(B.io)("https://flawless-psyche-307902.du.r.appspot.com"),this.myInfo=null}return Object(M.a)(e,[{key:"join",value:function(e){this.myInfo=e,this.socket.emit("join",e)}},{key:"onJoin",value:function(e,t){var n=this;this.socket.on("myInfo",(function(e){n.myInfo.key=e.key})),this.socket.on("userList",(function(t){t.forEach((function(t){e(t)}))})),this.socket.on("joinedUser",(function(t){e(t)})),this.socket.on("leavedUser",(function(e){t(e)}))}},{key:"offJoin",value:function(){this.socket.off("myInfo"),this.socket.off("userList"),this.socket.off("joinedUser"),this.socket.off("leavedUser")}},{key:"getMyInfo",value:function(){return this.myInfo}},{key:"changeStatus",value:function(e){this.socket.emit("changeStatus",e)}},{key:"onChangeStatus",value:function(e){this.socket.on("onChangeStatus",e)}},{key:"offChangeStatus",value:function(){this.socket.off("onChangeStatus")}},{key:"onError",value:function(e){console.error(e)}},{key:"onMessageReceived",value:function(e){this.socket.on("receivePrivateMessage",e)}},{key:"offMessageReceived",value:function(){this.socket.off("receivePrivateMessage")}},{key:"sendMessageToUser",value:function(e,t,n){var a={id:this.myInfo.id,key:this.myInfo.key,type:e,message:n};this.socket.emit("privateMessage",t,a)}}]),e}()),T=n(57),F=n.n(T),A=n(86),D={pcList:{},stream:null},R={iceServers:[{url:"stun:34.64.112.126:3478"},{url:"turn:34.64.112.126:3478?transport=udp",credential:"dmdcjfdl",username:"ekim"}],DtlsSrtpKeyAgreement:!0};function P(){return U.apply(this,arguments)}function U(){return(U=Object(A.a)(F.a.mark((function e(){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!D.stream){e.next=2;break}return e.abrupt("return",D.stream);case 2:return e.next=4,navigator.mediaDevices.getUserMedia({audio:!0});case 4:return D.stream=e.sent,e.abrupt("return",D.stream);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e){return new Promise((function(t,n){P().then((function(a){window.myStream=a;try{var c=new RTCPeerConnection(R);c.addStream(a),c.oniceconnectionstatechange=function(t){!function(e,t){console.log(e,t),console.log(D.pcList[e].connectionState),"connected"===D.pcList[e].connectionState&&console.log("connected")}(e,t)},D.pcList[e]=c,t(c)}catch(r){console.error(r),n(r)}}))}))}function H(e){console.error(e)}var z={getUserMedia:P,createOffer:function(e){return console.log("createOffer: "+e),new Promise((function(t,n){J(e).then((function(n){D.pcList[e].createOffer((function(a){D.pcList[e].setLocalDescription(a),t({pc:n,sessionDescription:a})}),H)})).catch((function(e){n(e)}))}))},createAnswer:function(e){return new Promise((function(t){"connected"!==D.pcList[e].connectionState&&D.pcList[e].createAnswer((function(n){D.pcList[e].setLocalDescription(n),t(n)}),H)}))},receiveOffer:function(e,t){if(console.log("receiveOffer: "+e),!D.pcList[e])return new Promise((function(n){J(e).then((function(e){e.setRemoteDescription(new RTCSessionDescription(t)),n(e)}))}))},receiveAnswer:function(e,t){D.pcList[e].setRemoteDescription(new RTCSessionDescription(t))},addIceCandidate:function(e,t){D.pcList[e]&&D.pcList[e].addIceCandidate(t)}};var K={getNewId:function(){return Math.round(99999999*Math.random())}},W=n(183),Y=n(87),q=n(185),$=Object(f.a)({root:function(e){return{backgroundColor:e.line.color,width:"".concat(e.line.width,"%"),height:"100%",display:"inline-block",borderRadius:e.line.isFirst?"0.3rem 0 0 0.3rem":e.line.isLast?"0 0.3rem 0.3rem 0":"0"}}});function G(e){var t=$(e);return c.a.createElement("span",{className:t.root})}Object(f.a)({});function Q(e){var t=e.className,n=e.lines;return c.a.createElement("div",{className:t},n.map((function(e,t){return c.a.createElement(G,{key:t,line:e})})))}var V=Object(f.a)({progress:{height:"1.5rem",backgroundColor:"#fff",borderRadius:"0.3rem"}});function X(e){Object(Y.a)(e);var t=V(),n=Object(a.useState)([{color:"#C6BDFB",width:15,isFirst:!0},{color:"#FFCBC0",width:10},{color:"#C6BDFB",width:35,isLast:!0}]),r=Object(l.a)(n,2),o=r[0];r[1];return c.a.createElement(q.a,null,c.a.createElement(Q,{className:t.progress,lines:o}))}var Z=Object(f.a)({mainBox:{backgroundColor:"#F1F3F6",padding:"10px 20px"}});function _(){var e=Z(),t=Object(s.g)(),n=t.teamId,r=t.userName,o=Object(a.useState)({key:"",id:K.getNewId(),name:r,team:n,status:"working"}),i=Object(l.a)(o,2),f=i[0],d=i[1],h=Object(a.useState)([]),g=Object(l.a)(h,2),b=g[0],p=g[1];function E(e){p((function(t){return[].concat(Object(u.a)(t),[e])}))}function y(e){var t=Object(u.a)(b).findIndex((function(t){return t.key===e.key})),n=Object(u.a)(b);n[t]=e,p((function(){return n}))}function v(e){p((function(t){return t.filter((function(t){return t.key!==e}))}))}function j(e){switch(e.type){case"offer":z.receiveOffer(e.id,e.message).then((function(t){t.onicecandidate=function(t){O(e.key,t)},t.onaddstream=function(t){w(e.key,t)},t.onremovestream=S,z.createAnswer(e.id).then((function(t){L.sendMessageToUser("answer",e.key,t)}))}));break;case"answer":z.receiveAnswer(e.id,e.message);break;case"candidate":console.log("candidate"),console.log(e),z.addIceCandidate(e.id,e.message);break;default:console.log(e)}}function O(e,t){t.candidate&&L.sendMessageToUser("candidate",e,t.candidate)}function w(e,t){var n=Object(u.a)(b).find((function(t){return t.key===e}));n&&(n.stream=t.stream,y(n))}function S(e){console.log(e)}function x(e){var t=Object(u.a)(b).find((function(t){return t.id===e.id}));t&&(t.status=e.status,y(t))}return Object(a.useEffect)((function(){L.join(f)}),[]),Object(a.useEffect)((function(){return L.onJoin(E,v),function(){L.offJoin()}})),Object(a.useEffect)((function(){return L.onChangeStatus(x),function(){L.offChangeStatus()}})),Object(a.useEffect)((function(){return L.onMessageReceived(j),function(){L.offMessageReceived()}})),Object(a.useEffect)((function(){L.changeStatus(f)}),[f]),c.a.createElement(W.a,{maxWidth:"md"},c.a.createElement(m.a,{container:!0,spacing:3,className:e.mainBox},c.a.createElement(m.a,{item:!0,xs:12,md:12},c.a.createElement(k.a,null,"TeleTele")),c.a.createElement(m.a,{item:!0,xs:12,md:6},c.a.createElement(N,{myInfo:f,setMyInfo:d})),c.a.createElement(m.a,{item:!0,xs:12,md:6},c.a.createElement(X,null))),c.a.createElement(C,{className:e.mainBox,memberList:b,offerToMember:function(e){z.createOffer(e.id,e.key).then((function(t){var n=t.pc,a=t.sessionDescription;n.onicecandidate=function(t){O(e.key,t)},n.onaddstream=function(t){w(e.key,t)},n.onremovestream=S,L.sendMessageToUser("offer",e.key,a)}))}}))}var ee=n(184),te=Object(f.a)({home:{position:"absolute",display:"flex",width:"100%",height:"100%",justifyContent:"center",alignItems:"center",flexDirection:"column",color:"#fff",background:"linear-gradient(45deg, #2196F3 30%, #21CBF3 90%)"},title:{height:"3rem",fontSize:"2rem"},startButton:{background:"linear-gradient(45deg, #FE6B8B 30%, #FF8E53 90%)",color:"#fff",width:"200px",height:"50px",borderRadius:"30px",fontSize:"1.2rem"},joinButton:{fontSize:"1.2rem",color:"#fff"}});function ne(){var e=te(),t=Object(s.f)(),n=Object(a.useState)(!1),r=Object(l.a)(n,2),o=r[0],i=r[1],u=Object(a.useState)(""),f=Object(l.a)(u,2),m=f[0],d=f[1],h=Object(a.useState)(""),g=Object(l.a)(h,2),b=g[0],p=g[1];function k(e){"Enter"===e.key&&(o?E():i(!0))}function E(){t.push("./team/".concat(m,"/").concat(b))}return c.a.createElement(q.a,{className:e.home},c.a.createElement("h2",{className:e.title},"T E L E P A T H Y"),c.a.createElement("h3",null,!o&&c.a.createElement(c.a.Fragment,null,c.a.createElement(ee.a,{label:"MY NAME",className:e.joinTextField,onChange:function(e){p(e.target.value)},onKeyPress:k,required:!0}),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement(y.a,{className:e.startButton,onClick:function(){i(!0)}},"START")),o&&c.a.createElement("div",null,c.a.createElement(y.a,{className:e.joinButton,onClick:E},"JOIN THE"),c.a.createElement(ee.a,{label:"TEAM",className:e.joinTextField,onChange:function(e){d(e.target.value)},onKeyPress:k}))))}var ae=function(){return c.a.createElement(i.a,{basename:"/our-telepathy"},c.a.createElement(s.c,null,c.a.createElement(s.a,{path:"/team/:teamId/:userName"},c.a.createElement(_,null)),c.a.createElement(s.a,{path:"/"},c.a.createElement(ne,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(ae,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},99:function(e,t,n){e.exports=n(144)}},[[99,1,2]]]);
//# sourceMappingURL=main.31329d69.chunk.js.map