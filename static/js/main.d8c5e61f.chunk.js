(this["webpackJsonpour-telepathy"]=this["webpackJsonpour-telepathy"]||[]).push([[0],{102:function(e,t,n){},142:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),c=n(10),r=n.n(c),i=(n(102),n(46)),s=n(11),u=n(36),l=n(23);function f(e){var t=e.memberList,n=e.offerToMember,c=Object(a.useRef)();return o.a.createElement("ul",null,t.map((function(e){return o.a.createElement("li",{key:e.key,onDoubleClick:function(){n(e)}},o.a.createElement("p",null,e.id),o.a.createElement("p",null,e.status),o.a.createElement("p",null,e.name),o.a.createElement("audio",{ref:c,onClick:(t=e.stream,void(t&&(c.current.srcObject=t,c.current.autoplay="autoplay")))}));var t})))}var m=n(172),d=n(175),h=n(177),p=n(184),g=n(185),k=n(178),b=n(179),v=n(174),E=Object(m.a)((function(e){return{orange:{color:e.palette.getContrastText(v.a[500]),backgroundColor:v.a[500]},cardHeader:{alignItems:"center"},cardContent:{display:"flex",justifyContent:"space-between"},cardStatusChip:{alignSelf:"center"},statusButton:{},workingStatusButton:{},restStatusButton:{},offStatusButton:{},selectedButton:{}}}));function y(e){var t=e.myInfo,n=E();return console.log(t),o.a.createElement(d.a,{elevation:0},o.a.createElement(h.a,{className:n.cardHeader,avatar:o.a.createElement(p.a,{className:n.orange},"\uc751"),title:t.name,action:o.a.createElement(g.a,{className:n.cardStatusChip,color:"primary",label:"\uc5c5\ubb34\uc911"})}),o.a.createElement(k.a,{className:n.cardContent},o.a.createElement(b.a,{className:n.workingStatusButton},"\uc5c5\ubb34\uc911"),o.a.createElement(b.a,{className:n.workingStatusButton},"\ud68c\uc758"),o.a.createElement(b.a,{className:n.restStatusButton},"\ud734\uc2dd"),o.a.createElement(b.a,{className:n.restStatusButton},"\uc2dd\uc0ac"),o.a.createElement(b.a,{className:n.offStatusButton},"\ud1f4\uadfc")))}var j=n(82),O=n(83),w=n(84),C={key:"",id:"",team:"",name:""},S=new(function(){function e(){Object(j.a)(this,e),this.socket=Object(w.io)("https://flawless-psyche-307902.du.r.appspot.com")}return Object(O.a)(e,[{key:"join",value:function(e){C.id=e.id,C.team=e.team,C.name=e.name,this.socket.emit("join",e)}},{key:"onJoin",value:function(e,t){this.socket.on("myInfo",(function(e){C.key=e.key})),this.socket.on("userList",(function(t){t.forEach((function(t){console.log(t),e(t)}))})),this.socket.on("joinedUser",(function(t){console.log(t),e(t)})),this.socket.on("leavedUser",(function(e){t(e)}))}},{key:"offJoin",value:function(){this.socket.off("myInfo"),this.socket.off("userList"),this.socket.off("joinedUser"),this.socket.off("leavedUser")}},{key:"getMyInfo",value:function(){return C}},{key:"sendChatMessageToAll",value:function(e,t){this.socket.emit("chatMessageToAll",e,t)}},{key:"onChatMessage",value:function(e){this.socket.on("receiveChatMessage",e)}},{key:"onError",value:function(e){console.error(e)}},{key:"onMessageReceived",value:function(e){this.socket.on("receivePrivateMessage",e)}},{key:"offMessageReceived",value:function(){this.socket.off("receivePrivateMessage")}},{key:"sendMessageToUser",value:function(e,t,n){var a={id:C.id,key:C.key,type:e,message:n};this.socket.emit("privateMessage",t,a)}}]),e}()),M=n(56),B=n.n(M),N=n(85),x={pcList:{},stream:null},L={iceServers:[{url:"stun:34.64.112.126:3478"},{url:"turn:34.64.112.126:3478?transport=udp",credential:"dmdcjfdl",username:"ekim"}],DtlsSrtpKeyAgreement:!0};function T(){return F.apply(this,arguments)}function F(){return(F=Object(N.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!x.stream){e.next=2;break}return e.abrupt("return",x.stream);case 2:return e.next=4,navigator.mediaDevices.getUserMedia({audio:!0});case 4:return x.stream=e.sent,e.abrupt("return",x.stream);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e){return new Promise((function(t,n){T().then((function(a){window.myStream=a;try{var o=new RTCPeerConnection(L);o.addStream(a),o.oniceconnectionstatechange=function(t){!function(e,t){console.log(e,t),console.log(x.pcList[e].connectionState),"connected"===x.pcList[e].connectionState&&console.log("connected")}(e,t)},x.pcList[e]=o,t(o)}catch(c){console.error(c),n(c)}}))}))}function D(e){console.error(e)}var R={getUserMedia:T,createOffer:function(e){return console.log("createOffer: "+e),new Promise((function(t,n){I(e).then((function(n){x.pcList[e].createOffer((function(a){x.pcList[e].setLocalDescription(a),t({pc:n,sessionDescription:a})}),D)})).catch((function(e){n(e)}))}))},createAnswer:function(e){return new Promise((function(t){"connected"!==x.pcList[e].connectionState&&x.pcList[e].createAnswer((function(n){x.pcList[e].setLocalDescription(n),t(n)}),D)}))},receiveOffer:function(e,t){if(console.log("receiveOffer: "+e),!x.pcList[e])return new Promise((function(n){I(e).then((function(e){e.setRemoteDescription(new RTCSessionDescription(t)),n(e)}))}))},receiveAnswer:function(e,t){x.pcList[e].setRemoteDescription(new RTCSessionDescription(t))},addIceCandidate:function(e,t){x.pcList[e]&&x.pcList[e].addIceCandidate(t)}};var A={getNewId:function(){return Math.round(99999999*Math.random())}},P=n(180),U=n(181),J=n(51),H=n(86),z=n(183),K=Object(m.a)({root:function(e){return{backgroundColor:e.line.color,width:"".concat(e.line.width,"%"),height:"100%",display:"inline-block",borderRadius:e.line.isFirst?"0.3rem 0 0 0.3rem":e.line.isLast?"0 0.3rem 0.3rem 0":"0"}}});function W(e){console.log(e);var t=K(e);return o.a.createElement("span",{className:t.root})}Object(m.a)({});function Y(e){var t=e.className,n=e.lines;return o.a.createElement("div",{className:t},n.map((function(e,t){return o.a.createElement(W,{key:t,line:e})})))}var q=Object(m.a)({progress:{height:"1.5rem",backgroundColor:"#fff",borderRadius:"0.3rem"}});function $(e){Object(H.a)(e);var t=q(),n=Object(a.useState)([{color:"#C6BDFB",width:15,isFirst:!0},{color:"#FFCBC0",width:10},{color:"#C6BDFB",width:35,isLast:!0}]),c=Object(l.a)(n,2),r=c[0];c[1];return o.a.createElement(z.a,null,o.a.createElement(Y,{className:t.progress,lines:r}))}var G=Object(m.a)({mainBox:{backgroundColor:"#F1F3F6",padding:"10px 40px"}});function Q(){var e=G(),t=Object(s.g)(),n=t.teamId,c=t.userName,r=Object(a.useState)({key:"",id:A.getNewId(),name:c,team:n}),i=Object(l.a)(r,2),m=i[0],d=(i[1],Object(a.useState)([])),h=Object(l.a)(d,2),p=(h[0],h[1]),g=Object(a.useState)([]),k=Object(l.a)(g,2),b=k[0],v=k[1];function E(e){v((function(t){return[].concat(Object(u.a)(t),[e])}))}function j(e){v((function(t){return t.filter((function(t){return t.key!==e}))}))}function O(e){p((function(t){return[].concat(Object(u.a)(t),[e])}))}function w(e){switch(e.type){case"offer":R.receiveOffer(e.id,e.message).then((function(t){t.onicecandidate=function(t){C(e.key,t)},t.onaddstream=function(t){M(e.key,t)},t.onremovestream=B,R.createAnswer(e.id).then((function(t){S.sendMessageToUser("answer",e.key,t)}))}));break;case"answer":R.receiveAnswer(e.id,e.message);break;case"candidate":console.log("candidate"),console.log(e),R.addIceCandidate(e.id,e.message);break;default:console.log(e)}}function C(e,t){t.candidate&&S.sendMessageToUser("candidate",e,t.candidate)}function M(e,t){var n=Object(u.a)(b).find((function(t){return t.key===e}));n&&(n.stream=t.stream,function(e){var t=Object(u.a)(b).findIndex((function(t){return t.key===e.key})),n=Object(u.a)(b);n[t]=e,v((function(){return n}))}(n))}function B(e){console.log(e)}return Object(a.useEffect)((function(){S.join(m)}),[]),Object(a.useEffect)((function(){return S.onJoin(E,j),function(){S.offJoin()}})),Object(a.useEffect)((function(){S.onChatMessage(O)}),[]),Object(a.useEffect)((function(){return S.onMessageReceived(w),function(){S.offMessageReceived()}})),o.a.createElement(P.a,{maxWidth:"md"},o.a.createElement(U.a,{container:!0,spacing:3,className:e.mainBox},o.a.createElement(U.a,{item:!0,xs:12,md:12},o.a.createElement(J.a,null,"TeleTele")),o.a.createElement(U.a,{item:!0,xs:6,md:6},o.a.createElement(y,{myInfo:m})),o.a.createElement(U.a,{item:!0,xs:6,md:6},o.a.createElement($,null))),o.a.createElement(f,{memberList:b,offerToMember:function(e){R.createOffer(e.id,e.key).then((function(t){var n=t.pc,a=t.sessionDescription;n.onicecandidate=function(t){C(e.key,t)},n.onaddstream=function(t){M(e.key,t)},n.onremovestream=B,S.sendMessageToUser("offer",e.key,a)}))}}))}var V=n(182),X=Object(m.a)({home:{position:"absolute",display:"flex",width:"100%",height:"100%",justifyContent:"center",alignItems:"center",flexDirection:"column",color:"#fff",background:"linear-gradient(45deg, #2196F3 30%, #21CBF3 90%)"},title:{height:"3rem",fontSize:"2rem"},startButton:{background:"linear-gradient(45deg, #FE6B8B 30%, #FF8E53 90%)",color:"#fff",width:"200px",height:"50px",borderRadius:"30px",fontSize:"1.2rem"},joinButton:{fontSize:"1.2rem",color:"#fff"}});function Z(){var e=X(),t=Object(s.f)(),n=Object(a.useState)(!1),c=Object(l.a)(n,2),r=c[0],i=c[1],u=Object(a.useState)(""),f=Object(l.a)(u,2),m=f[0],d=f[1],h=Object(a.useState)(""),p=Object(l.a)(h,2),g=p[0],k=p[1];function v(e){"Enter"===e.key&&(r?E():i(!0))}function E(){t.push("./team/".concat(m,"/").concat(g))}return o.a.createElement(z.a,{className:e.home},o.a.createElement("h2",{className:e.title},"T E L E P A T H Y"),o.a.createElement("h3",null,!r&&o.a.createElement(o.a.Fragment,null,o.a.createElement(V.a,{label:"MY NAME",className:e.joinTextField,onChange:function(e){k(e.target.value)},onKeyPress:v,required:!0}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(b.a,{className:e.startButton,onClick:function(){i(!0)}},"START")),r&&o.a.createElement("div",null,o.a.createElement(b.a,{className:e.joinButton,onClick:E},"JOIN THE"),o.a.createElement(V.a,{label:"TEAM",className:e.joinTextField,onChange:function(e){d(e.target.value)},onKeyPress:v}))))}var _=function(){return o.a.createElement(i.a,{basename:"/our-telepathy"},o.a.createElement(s.c,null,o.a.createElement(s.a,{path:"/team/:teamId/:userName"},o.a.createElement(Q,null)),o.a.createElement(s.a,{path:"/"},o.a.createElement(Z,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(_,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},97:function(e,t,n){e.exports=n(142)}},[[97,1,2]]]);
//# sourceMappingURL=main.d8c5e61f.chunk.js.map