(this["webpackJsonpour-telepathy"]=this["webpackJsonpour-telepathy"]||[]).push([[0],{103:function(e,t,n){},143:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(10),o=n.n(r),i=(n(103),n(46)),s=n(11),l=n(37),u=n(23),m=n(172),f=n(175),d=n(177),g=n(178),p=n(184),h=n(185),b=n(179),k=n(174),v=Object(m.a)((function(e){return{orange:{color:e.palette.getContrastText(k.a[500]),backgroundColor:k.a[500]},cardHeader:{alignItems:"center"},cardContent:{display:"flex",justifyContent:"space-between"},cardStatusChip:{alignSelf:"center"}}}));function E(e){var t=e.member,n=v();return c.a.createElement(f.a,{item:!0,xs:3,md:3},c.a.createElement(d.a,null,c.a.createElement(g.a,{className:n.cardHeader,avatar:c.a.createElement(p.a,{className:n.orange},"O"),title:t.name,action:c.a.createElement(h.a,{className:n.cardStatusChip,color:"primary",label:"\uc5c5\ubb34\uc911"})}),c.a.createElement(b.a,{className:n.cardContent})))}var y=Object(m.a)({memberBox:{padding:"10px 40px",marginTop:"20px"}});function j(e){var t=e.memberList,n=(e.offerToMember,y());return c.a.createElement(f.a,{container:!0,spacing:3,className:n.memberBox},t.map((function(e){return c.a.createElement(E,{key:e.id,member:e})})))}var O=n(180),w=Object(m.a)((function(e){return{orange:{color:e.palette.getContrastText(k.a[500]),backgroundColor:k.a[500]},cardHeader:{alignItems:"center"},cardContent:{display:"flex",justifyContent:"space-between"},cardStatusChip:{alignSelf:"center"},statusButton:{},workingStatusButton:{},restStatusButton:{},offStatusButton:{},selectedButton:{}}}));function C(e){var t=e.myInfo,n=w();return console.log(t),c.a.createElement(d.a,{elevation:0},c.a.createElement(g.a,{className:n.cardHeader,avatar:c.a.createElement(p.a,{className:n.orange},"\uc751"),title:t.name,action:c.a.createElement(h.a,{className:n.cardStatusChip,color:"primary",label:"\uc5c5\ubb34\uc911"})}),c.a.createElement(b.a,{className:n.cardContent},c.a.createElement(O.a,{className:n.workingStatusButton},"\uc5c5\ubb34\uc911"),c.a.createElement(O.a,{className:n.workingStatusButton},"\ud68c\uc758"),c.a.createElement(O.a,{className:n.restStatusButton},"\ud734\uc2dd"),c.a.createElement(O.a,{className:n.restStatusButton},"\uc2dd\uc0ac"),c.a.createElement(O.a,{className:n.offStatusButton},"\ud1f4\uadfc")))}var S=n(82),N=n(83),x=n(84),B={key:"",id:"",team:"",name:""},M=new(function(){function e(){Object(S.a)(this,e),this.socket=Object(x.io)("https://flawless-psyche-307902.du.r.appspot.com")}return Object(N.a)(e,[{key:"join",value:function(e){B.id=e.id,B.team=e.team,B.name=e.name,this.socket.emit("join",e)}},{key:"onJoin",value:function(e,t){this.socket.on("myInfo",(function(e){B.key=e.key})),this.socket.on("userList",(function(t){t.forEach((function(t){console.log(t),e(t)}))})),this.socket.on("joinedUser",(function(t){console.log(t),e(t)})),this.socket.on("leavedUser",(function(e){t(e)}))}},{key:"offJoin",value:function(){this.socket.off("myInfo"),this.socket.off("userList"),this.socket.off("joinedUser"),this.socket.off("leavedUser")}},{key:"getMyInfo",value:function(){return B}},{key:"sendChatMessageToAll",value:function(e,t){this.socket.emit("chatMessageToAll",e,t)}},{key:"onChatMessage",value:function(e){this.socket.on("receiveChatMessage",e)}},{key:"onError",value:function(e){console.error(e)}},{key:"onMessageReceived",value:function(e){this.socket.on("receivePrivateMessage",e)}},{key:"offMessageReceived",value:function(){this.socket.off("receivePrivateMessage")}},{key:"sendMessageToUser",value:function(e,t,n){var a={id:B.id,key:B.key,type:e,message:n};this.socket.emit("privateMessage",t,a)}}]),e}()),T=n(56),L=n.n(T),I=n(85),F={pcList:{},stream:null},D={iceServers:[{url:"stun:34.64.112.126:3478"},{url:"turn:34.64.112.126:3478?transport=udp",credential:"dmdcjfdl",username:"ekim"}],DtlsSrtpKeyAgreement:!0};function R(){return A.apply(this,arguments)}function A(){return(A=Object(I.a)(L.a.mark((function e(){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!F.stream){e.next=2;break}return e.abrupt("return",F.stream);case 2:return e.next=4,navigator.mediaDevices.getUserMedia({audio:!0});case 4:return F.stream=e.sent,e.abrupt("return",F.stream);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){return new Promise((function(t,n){R().then((function(a){window.myStream=a;try{var c=new RTCPeerConnection(D);c.addStream(a),c.oniceconnectionstatechange=function(t){!function(e,t){console.log(e,t),console.log(F.pcList[e].connectionState),"connected"===F.pcList[e].connectionState&&console.log("connected")}(e,t)},F.pcList[e]=c,t(c)}catch(r){console.error(r),n(r)}}))}))}function U(e){console.error(e)}var J={getUserMedia:R,createOffer:function(e){return console.log("createOffer: "+e),new Promise((function(t,n){P(e).then((function(n){F.pcList[e].createOffer((function(a){F.pcList[e].setLocalDescription(a),t({pc:n,sessionDescription:a})}),U)})).catch((function(e){n(e)}))}))},createAnswer:function(e){return new Promise((function(t){"connected"!==F.pcList[e].connectionState&&F.pcList[e].createAnswer((function(n){F.pcList[e].setLocalDescription(n),t(n)}),U)}))},receiveOffer:function(e,t){if(console.log("receiveOffer: "+e),!F.pcList[e])return new Promise((function(n){P(e).then((function(e){e.setRemoteDescription(new RTCSessionDescription(t)),n(e)}))}))},receiveAnswer:function(e,t){F.pcList[e].setRemoteDescription(new RTCSessionDescription(t))},addIceCandidate:function(e,t){F.pcList[e]&&F.pcList[e].addIceCandidate(t)}};var H={getNewId:function(){return Math.round(99999999*Math.random())}},z=n(181),K=n(51),W=n(86),Y=n(183),q=Object(m.a)({root:function(e){return{backgroundColor:e.line.color,width:"".concat(e.line.width,"%"),height:"100%",display:"inline-block",borderRadius:e.line.isFirst?"0.3rem 0 0 0.3rem":e.line.isLast?"0 0.3rem 0.3rem 0":"0"}}});function $(e){var t=q(e);return c.a.createElement("span",{className:t.root})}Object(m.a)({});function G(e){var t=e.className,n=e.lines;return c.a.createElement("div",{className:t},n.map((function(e,t){return c.a.createElement($,{key:t,line:e})})))}var Q=Object(m.a)({progress:{height:"1.5rem",backgroundColor:"#fff",borderRadius:"0.3rem"}});function V(e){Object(W.a)(e);var t=Q(),n=Object(a.useState)([{color:"#C6BDFB",width:15,isFirst:!0},{color:"#FFCBC0",width:10},{color:"#C6BDFB",width:35,isLast:!0}]),r=Object(u.a)(n,2),o=r[0];r[1];return c.a.createElement(Y.a,null,c.a.createElement(G,{className:t.progress,lines:o}))}var X=Object(m.a)({mainBox:{backgroundColor:"#F1F3F6",padding:"10px 40px"}});function Z(){var e=X(),t=Object(s.g)(),n=t.teamId,r=t.userName,o=Object(a.useState)({key:"",id:H.getNewId(),name:r,team:n}),i=Object(u.a)(o,2),m=i[0],d=(i[1],Object(a.useState)([])),g=Object(u.a)(d,2),p=(g[0],g[1]),h=Object(a.useState)([]),b=Object(u.a)(h,2),k=b[0],v=b[1];function E(e){v((function(t){return[].concat(Object(l.a)(t),[e])}))}function y(e){v((function(t){return t.filter((function(t){return t.key!==e}))}))}function O(e){p((function(t){return[].concat(Object(l.a)(t),[e])}))}function w(e){switch(e.type){case"offer":J.receiveOffer(e.id,e.message).then((function(t){t.onicecandidate=function(t){S(e.key,t)},t.onaddstream=function(t){N(e.key,t)},t.onremovestream=x,J.createAnswer(e.id).then((function(t){M.sendMessageToUser("answer",e.key,t)}))}));break;case"answer":J.receiveAnswer(e.id,e.message);break;case"candidate":console.log("candidate"),console.log(e),J.addIceCandidate(e.id,e.message);break;default:console.log(e)}}function S(e,t){t.candidate&&M.sendMessageToUser("candidate",e,t.candidate)}function N(e,t){var n=Object(l.a)(k).find((function(t){return t.key===e}));n&&(n.stream=t.stream,function(e){var t=Object(l.a)(k).findIndex((function(t){return t.key===e.key})),n=Object(l.a)(k);n[t]=e,v((function(){return n}))}(n))}function x(e){console.log(e)}return Object(a.useEffect)((function(){M.join(m)}),[]),Object(a.useEffect)((function(){return M.onJoin(E,y),function(){M.offJoin()}})),Object(a.useEffect)((function(){M.onChatMessage(O)}),[]),Object(a.useEffect)((function(){return M.onMessageReceived(w),function(){M.offMessageReceived()}})),c.a.createElement(z.a,{maxWidth:"md"},c.a.createElement(f.a,{container:!0,spacing:3,className:e.mainBox},c.a.createElement(f.a,{item:!0,xs:12,md:12},c.a.createElement(K.a,null,"TeleTele")),c.a.createElement(f.a,{item:!0,xs:6,md:6},c.a.createElement(C,{myInfo:m})),c.a.createElement(f.a,{item:!0,xs:6,md:6},c.a.createElement(V,null))),c.a.createElement(j,{className:e.mainBox,memberList:k,offerToMember:function(e){J.createOffer(e.id,e.key).then((function(t){var n=t.pc,a=t.sessionDescription;n.onicecandidate=function(t){S(e.key,t)},n.onaddstream=function(t){N(e.key,t)},n.onremovestream=x,M.sendMessageToUser("offer",e.key,a)}))}}))}var _=n(182),ee=Object(m.a)({home:{position:"absolute",display:"flex",width:"100%",height:"100%",justifyContent:"center",alignItems:"center",flexDirection:"column",color:"#fff",background:"linear-gradient(45deg, #2196F3 30%, #21CBF3 90%)"},title:{height:"3rem",fontSize:"2rem"},startButton:{background:"linear-gradient(45deg, #FE6B8B 30%, #FF8E53 90%)",color:"#fff",width:"200px",height:"50px",borderRadius:"30px",fontSize:"1.2rem"},joinButton:{fontSize:"1.2rem",color:"#fff"}});function te(){var e=ee(),t=Object(s.f)(),n=Object(a.useState)(!1),r=Object(u.a)(n,2),o=r[0],i=r[1],l=Object(a.useState)(""),m=Object(u.a)(l,2),f=m[0],d=m[1],g=Object(a.useState)(""),p=Object(u.a)(g,2),h=p[0],b=p[1];function k(e){"Enter"===e.key&&(o?v():i(!0))}function v(){t.push("./team/".concat(f,"/").concat(h))}return c.a.createElement(Y.a,{className:e.home},c.a.createElement("h2",{className:e.title},"T E L E P A T H Y"),c.a.createElement("h3",null,!o&&c.a.createElement(c.a.Fragment,null,c.a.createElement(_.a,{label:"MY NAME",className:e.joinTextField,onChange:function(e){b(e.target.value)},onKeyPress:k,required:!0}),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement(O.a,{className:e.startButton,onClick:function(){i(!0)}},"START")),o&&c.a.createElement("div",null,c.a.createElement(O.a,{className:e.joinButton,onClick:v},"JOIN THE"),c.a.createElement(_.a,{label:"TEAM",className:e.joinTextField,onChange:function(e){d(e.target.value)},onKeyPress:k}))))}var ne=function(){return c.a.createElement(i.a,{basename:"/our-telepathy"},c.a.createElement(s.c,null,c.a.createElement(s.a,{path:"/team/:teamId/:userName"},c.a.createElement(Z,null)),c.a.createElement(s.a,{path:"/"},c.a.createElement(te,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(ne,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},98:function(e,t,n){e.exports=n(143)}},[[98,1,2]]]);
//# sourceMappingURL=main.f95abc37.chunk.js.map